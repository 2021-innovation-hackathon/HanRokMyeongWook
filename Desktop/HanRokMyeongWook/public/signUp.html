<!DOCTYPE html>
<html lang="en">

<head>
    <style>
        @font-face {
        font-family: 'WandohopeB';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_20-10@1.0/WandohopeB.woff') format('woff');
        font-weight: normal;
        font-style: normal;
       }
      </style>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="img/logo/logo.png" rel="icon">
    <title>너나들이 - 회원가입</title>
    <link href="css/all.min.css" rel="stylesheet" type="text/css">
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="css/ruang-admin.min.css" rel="stylesheet">

</head>

<body class="bg-gradient-login">
    <!-- 데이터베이스 쪽 -->
    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-app.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-firestore.js"></script>


    
    


    <!-- Sidebar -->
    <div id="content-wrapper" class="d-flex flex-column">
        <div id="content">
        <!-- TopBar -->
        <nav class="navbar navbar-expand navbar-light bg-navbar topbar mb-4 static-top">
            
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
            <div class="sidebar-brand-icon">
                <img src="css/logo.png" width="40">
            </div>
            <div class="sidebar-brand-text mx-3" style="color:#fff; font-size: 1.5em; font-family: 'WandohopeB';" >너나들이</div>
            
            </a>
            
        </nav>
        <!-- Topbar -->
    <!-- Register Content -->
    <div class="container-login">
        <div class="row justify-content-center">
        <div class="col-xl-10 col-lg-12 col-md-9">
            <div class="card shadow-sm my-5">
            <div class="card-body p-0">
                <div class="row">
                <div class="col-lg-12">
                    <div class="login-form">
                    <div class="text-center">
                        <h1 class="h4 text-gray-900 mb-4">회원가입</h1>
                    </div>
                    <form>
                        <div class="form-group">
                        <label>이메일</label>
                        <input type="text" class="form-control" id="new_email" aria-describedby="emailHelp"
                            placeholder="이메일을 입력하세요">
                        </div>
                        <div class="form-group">
                        <label>비밀번호</label>
                        <input type="password" class="form-control" id="new_pw_1" data-type="password" placeholder="비밀번호">
                        </div>
                        <div class="form-group">
                        <label>비밀번호 확인</label>
                        <input type="password" class="form-control" id="new_pw_2"  data-type="password"
                            placeholder="비밀번호 확인">
                        </div>
                        <div class="form-group">
                        <label>이름</label>
                        <input type="text" class="form-control" id="new_name" placeholder="이름을 입력하세요">
                        </div>
                        <div class="form-group">
                            <label>나이</label>
                            <input type="text" class="form-control" id="new_age" placeholder="나이를 입력하세요">
                            </div>
                        <table>
                        <tr>
                            <label>학번</label>
                        </tr>
                        <tr>
                        <td valgn="top">
                        <select id="select0" onchange="alert_select_value_sid(this);">
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                        </select>
                          </td>        
                          </tr>
                        </table>
      
                        <div class="form-group">
                        </div>
                        <!-- <div class="form-group">
                        <label>학번</label>
                        <input type="text" class="form-control" id="new_sid" placeholder="학번을 입력하세요">
                        </div>                                      -->
                    <table>
                        <tr>
                        <label>학과</label>
                        </tr>
                        <tr>
                        <td valgn="top">
                        <select id="select1" onchange="alert_select_value(this);">
                            <option value="소프트웨어공학과">소프트웨어공학과</option>
                            <option value="전자정보통신공학전공">전자정보통신공학전공</option>
                            <option value="컴퓨터정보통신공학전공">컴퓨터정보통신공학전공</option>
                        </select>
                        </td>
                        </tr>
                    </table>
                    
                    <div class="form-group">
                        
                    </div>

                    
                    <table>
                        <tr>
                        <label>성별</label>
                        </tr>
                        <tr>
                      <td valgn="top">
                        <select id="select2" onchange="alert_select_value_sex(this);">
                          <option value="남자">남자</option>
                          <option value="여자">여자</option>
                        </select>
                      </td>
                        </tr>
                    </table>
    
                    <div class="form-group">
                    </div>

                        <div class="form-group">
                        <button type="button" class="btn btn-primary btn-block" onClick="newuser();">회원가입</button>
                        </div>
                    
                    </form>
                    <hr>
                    <div class="text-center">
                        <a class="font-weight-bold small" href="logIn.html">혹시 계정이 있으신가요?</a>
                    </div>
                    <div class="text-center">
                    </div>
                    </div>
                </div>
                </div>
            </div>
            </div>
        </div>
        </div>
    </div>


    <script>
        const collection = "Users"
        var selected_value = "소프트웨어공학과"
        var sex = "남자"
        var hid = "10"

        //학과 고르는거
        var alert_select_value = function (select_obj){
            // 우선 selectbox에서 선택된 index를 찾고 
            var selected_index = select_obj.selectedIndex;
            // 선택된 index의 value를 찾고 
            selected_value = select_obj.options[selected_index].value;
            // 원하는 동작을 수행한다. 여기서는 그냥 alert해주는 식으로만 처리함. 
        };

        //성별 고르는거
        var alert_select_value_sex = function (select_obj){
            // 우선 selectbox에서 선택된 index를 찾고 
            var selected_index = select_obj.selectedIndex;
            // 선택된 index의 value를 찾고 
            sex = select_obj.options[selected_index].value;
            // 원하는 동작을 수행한다. 여기서는 그냥 alert해주는 식으로만 처리함. 
        };

        //학번 고르는거
        var alert_select_value_sid = function (select_obj){
            // 우선 selectbox에서 선택된 index를 찾고 
            var selected_index = select_obj.selectedIndex;
            // 선택된 index의 value를 찾고 
            hid = select_obj.options[selected_index].value;
            // 원하는 동작을 수행한다. 여기서는 그냥 alert해주는 식으로만 처리함. 
        };


        const firebaseConfig = {
          apiKey: "AIzaSyDhDAsu763cvxiR7cyHxYm5onM8Q0AwR6Y",
          authDomain: "jnu-test.firebaseapp.com",
          projectId: "jnu-test",
          storageBucket: "jnu-test.appspot.com",
          messagingSenderId: "1085946242507",
          appId: "1:1085946242507:web:4f9232c942ccab7ea0424e",
          measurementId: "G-N8GDG17QZC"
        };
        firebase.initializeApp(firebaseConfig);

        // require("firebase/auth");
        // require("firebase/firestore");
        // firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();

        function newuser() {
            email = document.getElementById('new_email').value
            new_pw_1 = document.getElementById('new_pw_1').value
            new_pw_2 = document.getElementById('new_pw_2').value
            new_name = document.getElementById('new_name').value
            new_age = document.getElementById('new_age').value
            //new_sid = document.getElementById('new_sid').value
            introduce = ""
            if (new_pw_1 != new_pw_2) {
                alert("확인 비밀번호가 다릅니다.")
            } else {     
                
                //입력받은 데이터 db에 넣는거
                const data = {
                    pw: new_pw_2,
                    name: new_name,
                    sid : hid,
                    major: selected_value,
                    sex: sex,
                    intro: introduce,
                    age: new_age
                    };

                const res = db.collection(collection).doc(email).set(data);


                firebase.auth().createUserWithEmailAndPassword(email, new_pw_2)
                    .then(() => {
                        alert('회원가입이 완료되었습니다.')
                        document.location.href = "index.html";
                    })
                    .catch(function (error) {
                        var errorCode = error.code;
                        var errorMessage = error.message;
                        alert(error.code)
                    });
            }
        }
       
    </script>

    <script>
        function move() {
        location = 'chat.html'
        }
    </script>


    <!-- Register Content -->
    <!-- <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="js/ruang-admin.min.js"></script> -->
</body>

</html>